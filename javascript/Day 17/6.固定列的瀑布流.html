<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<style>
			*{
				padding:0;margin:0;
			}
			ul{
				width: 960px;
				margin:0 auto;
			}
			ul li{
				width: 230px;
				float: left;
				list-style: none;
				margin:5px;
			
			}
			ul li div{
				width: 230px;
			}
			ul li div img{
				width: 230px;
				display: block;
			}
		</style>
	</head>
	<body>
		<ul>
			<li></li>
			<li></li>
			<li></li>
			<li></li>
			<!--<div><img src="img1/1.jpg"/></div>-->
		</ul>
		<script type="text/javascript">
			var arr=[
					{"src":"img1/1.jpg","alt":"1","height":"343px"},
					{"src":"img1/2.jpg","alt":"2","height":"300px"},
					{"src":"img1/3.jpg","alt":"3","height":"230px"},
					{"src":"img1/4.jpg","alt":"4","height":"230px"},
					{"src":"img1/5.jpg","alt":"5","height":"306px"},
					{"src":"img1/6.jpg","alt":"6","height":"333px"},
					{"src":"img1/7.jpg","alt":"7","height":"335px"},
					{"src":"img1/8.jpg","alt":"8","height":"172px"},
					{"src":"img1/9.jpg","alt":"9","height":"172px"},
					{"src":"img1/10.jpg","alt":"10","height":"345px"},
					{"src":"img1/11.jpg","alt":"11","height":"340px"},
					{"src":"img1/12.jpg","alt":"12","height":"153px"},
					{"src":"img1/13.jpg","alt":"13","height":"345px"},
					{"src":"img1/14.jpg","alt":"14","height":"316px"},
					{"src":"img1/15.jpg","alt":"15","height":"327px"},
					{"src":"img1/16.jpg","alt":"16","height":"345px"},
					{"src":"img1/17.jpg","alt":"17","height":"172px"},
					{"src":"img1/18.jpg","alt":"18","height":"282px"},
					{"src":"img1/19.jpg","alt":"19","height":"224px"},
					{"src":"img1/20.jpg","alt":"20","height":"344px"}		
			];
			
			//div包含img，往li高度最小的盒子里面添加。
			
			var aLi=document.getElementsByTagName('li');//类数组
			
			
			function getIndex(array){//array:类数组   返回数组对象offsetHeight最小的那个元素对象的索引。
				var minIndex=0;//最小索引
				var minValue=array[minIndex].offsetHeight;
				for(var i=0;i<array.length;i++){
					if(minValue>array[i].offsetHeight){
						minValue=array[i].offsetHeight;
						minIndex=i;
					}
				}
				return minIndex;//返回最小的li的索引
			}
			
			
			/*for(var i=0;i<arr.length;i++){
				var cdiv=document.createElement('div');
				cdiv.style.marginBottom='10px';
				var cimg=document.createElement('img');
				cimg.src=arr[i].src;
				cimg.style.width='230px';
				cimg.style.height=arr[i].height;
				cdiv.appendChild(cimg);
				aLi[getIndex(aLi)].appendChild(cdiv);
			}*/
			createpic();
			function createpic(){
				for(var i=0;i<arr.length;i++){
					var cdiv=document.createElement('div');
					cdiv.style.marginBottom='10px';
					var cimg=document.createElement('img');
					cimg.src=arr[i].src;
					cimg.style.width='230px';
					cimg.style.height=arr[i].height;
					cdiv.appendChild(cimg);
					aLi[getIndex(aLi)].appendChild(cdiv);
				}
			}
			//加载更多(onscroll)
			//可视区的高度+scrollTop
			//盒子：offsetHeight
			//aLi[getIndex(aLi)]:最小li高度
			
			window.onscroll=function(){
				var clientHeight=document.documentElement.clientHeight;
				var scrolltop=document.documentElement.scrollTop||document.body.scrollTop;
				if(aLi[getIndex(aLi)].offsetHeight<clientHeight+scrolltop){
					createpic();
				}
			}
			
			
			/*window.onload=function(){//window.onload下面获取被图片撑大的盒子的offsetHeight
				alert(aLi[0].offsetHeight);//12==>16   14==>19   16=21
			}*/
			
			
	
			//图片高度存在撑大盒子的高度
			//offsetHeight = 内容可视区域的高度+ 滚动条 + 边框。
		</script>
	</body>
</html>
